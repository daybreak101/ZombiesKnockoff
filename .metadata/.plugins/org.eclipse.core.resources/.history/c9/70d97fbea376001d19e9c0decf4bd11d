package entities.statics;

import java.awt.Graphics;

import graphics.Assets;
import main.Handler;

public class Barrier extends InteractableStaticEntity {

	private int health;
	private boolean broken, cantAfford;
	
	public Barrier(Handler handler, float x, float y, int width, int height) {
		super(handler, x, y, width, height);
		broken = false;
		cantAfford = false;
		triggerText = "Press F to repair barricade";
	}
	
	

	@Override
	public void render(Graphics g) {
		if(broken)
			g.drawImage(Assets.stone, (int) (x - handler.getGameCamera().getxOffset()), (int) (y - handler.getGameCamera().getyOffset()), width, height, null );
		else
			g.drawImage(Assets.mysteryBox, (int) (x - handler.getGameCamera().getxOffset()), (int) (y - handler.getGameCamera().getyOffset()), width, height, null );
		
	}

	
	public void fulfillInteraction() {
		if(cooldownTimer >= cooldown &&
				!(handler.getWorld().getEntityManager().getPlayer().getInv().getGun().getCurrentReserve() == handler.getWorld().getEntityManager().getPlayer().getInv().getGun().getMaxReserve())) {
			cooldownTimer = 0;
			if(handler.getWorld().getEntityManager().getPlayer().purchase(60)) {
				handler.getWorld().getEntityManager().getPlayer().purchaseAmmo();
				cantAfford = false;
			}
			else {
				cantAfford = true;
				cooldownTimer = 0;
			}
			
		}
		if(cooldownTimer >= cooldown && (handler.getPlayer().getInv().getGun().getName() == "Flamethrower" || handler.getPlayer().getInv().getGun().getName() == "HotBox") && 
				!(handler.getPlayer().getInv().getGun().getCurrentClip() == handler.getPlayer().getInv().getGun().getClip())) {
			cooldownTimer = 0;
			if(handler.getWorld().getEntityManager().getPlayer().purchase(50)) {
				handler.getWorld().getEntityManager().getPlayer().purchaseAmmo();
				cantAfford = false;
			}
			else {
				cantAfford = true;
				cooldownTimer = 0;
			}
			
		}
		else if(handler.getWorld().getEntityManager().getPlayer().getInv().getGun().getCurrentReserve() == handler.getWorld().getEntityManager().getPlayer().getInv().getGun().getMaxReserve()) {
			cooldownTimer = 0;
			fullAmmo = true;
		}
		
		
	}

	@Override
	public void postTick() {
		
		if(cantAfford && cooldownTimer < cooldown) {
			triggerText = "              Not enough points!";
		}
		else if(fullAmmo && cooldownTimer < cooldown) {
			triggerText = "                Full on ammo!";
		}
		else if(cooldownTimer >= cooldown) {
			fullAmmo = false;
			triggerText = "Press F to refill current weapon: 1000";
		}
		else {
			triggerText = "";
		}
	}
}
